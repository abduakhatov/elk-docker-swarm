# Starting from 7.4.0, Automated Snapshot can be configured natively on Elasticsearch (Snapshot Lifecycle Policy)
actions:
  # 1:
  #   action: snapshot
  #   description: >-
  #     Snapshot indices to the configured Elasticsearch Repository.
  #     Snapshots into => `elasticsearch-snapshot-%Y.%m.%d-%H:%M:%S`
  #   options:
  #     repository: elasticsearch-backup
  #     name: elasticsearch-snapshot-%Y.%m.%d-%H:%M
  #     include_global_state: True
  #     wait_for_completion: True
  #     ignore_empty_list: True
  #     max_wait: -1
  #     wait_interval: 20
  #     allow_ilm_indices: true
  #   filters:
  #     - filtertype: pattern
  #       kind: regex
  #       value: "^(filebeat-|logstash-|.kibana).*$"
  # 2:
  #   action: delete_snapshots
  #   description: >-
  #     Delete snapshots older than configured
  #   options:
  #     repository: elasticsearch-backup
  #     retry_interval: 30
  #     retry_count: 2
  #     ignore_empty_list: True
  #     disable_action: false
  #   filters:
  #     - filtertype: pattern
  #       kind: prefix
  #       value: elasticsearch-snapshot-
  #     - filtertype: age
  #       source: creation_date
  #       direction: older
  #       unit: days
  #       unit_count: 180

  1:
    action: delete_indices
    description: >-
      Delete indices older than 7 days (based on index name), for filebeat-
      prefixed indices. Ignore the error if the filter does not result in an
      actionable list of indices (ignore_empty_list) and exit cleanly.
    options:
      ignore_empty_list: True
      disable_action: False
    filters:
      - filtertype: pattern
        kind: prefix
        value: filebeat-
      - filtertype: age
        source: name
        direction: older
        timestring: "%Y.%m.%d"
        unit: days
        unit_count: 7
